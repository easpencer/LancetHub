'use client';

import { motion } from 'framer-motion';
import styles from './pandemic-vulnerability.module.css';

export default function ScoringMethodology({ isOpen, onClose }) {
  if (!isOpen) return null;

  return (
    <motion.div 
      className={styles.modalOverlay}
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      onClick={onClose}
    >
      <motion.div 
        className={styles.methodologyModal}
        initial={{ scale: 0.8, opacity: 0 }}
        animate={{ scale: 1, opacity: 1 }}
        exit={{ scale: 0.8, opacity: 0 }}
        onClick={(e) => e.stopPropagation()}
      >
        <div className={styles.modalHeader}>
          <h2>Pandemic Vulnerability Scoring Methodology</h2>
          <button onClick={onClose} className={styles.closeButton}>×</button>
        </div>
        
        <div className={styles.modalContent}>
          <section className={styles.methodologySection}>
            <h3>Overall Vulnerability Score Calculation</h3>
            <p>Each country's pandemic vulnerability is calculated using a weighted composite score:</p>
            
            <div className={styles.formulaBox}>
              <strong>Vulnerability Index = </strong>
              <span className={styles.formula}>
                (100 - Healthcare Capacity) × 0.4 + Social Vulnerability × 0.4 + (100 - Economic Resilience) × 0.2
              </span>
            </div>
            
            <div className={styles.scoreBreakdown}>
              <h4>Score Components:</h4>
              <ul>
                <li><strong>Healthcare Capacity (40% weight)</strong>: Hospital beds per capita, healthcare workers, medical infrastructure, pandemic preparedness plans</li>
                <li><strong>Social Vulnerability (40% weight)</strong>: Population density, age demographics, chronic disease prevalence, social cohesion</li>
                <li><strong>Economic Resilience (20% weight)</strong>: GDP per capita, healthcare spending, social safety nets, economic diversity</li>
              </ul>
            </div>
          </section>

          <section className={styles.methodologySection}>
            <h3>Risk Level Classification</h3>
            <div className={styles.riskLevels}>
              <div className={styles.riskLevel}>
                <span className={styles.riskColor} style={{background: '#FF4444'}}></span>
                <strong>Very High (80-100)</strong>: Critical vulnerabilities across multiple dimensions
              </div>
              <div className={styles.riskLevel}>
                <span className={styles.riskColor} style={{background: '#FF9800'}}></span>
                <strong>High (60-79)</strong>: Significant gaps in pandemic preparedness
              </div>
              <div className={styles.riskLevel}>
                <span className={styles.riskColor} style={{background: '#FFD700'}}></span>
                <strong>Medium (40-59)</strong>: Moderate vulnerabilities requiring attention
              </div>
              <div className={styles.riskLevel}>
                <span className={styles.riskColor} style={{background: '#90EE90'}}></span>
                <strong>Low (20-39)</strong>: Good preparedness with minor gaps
              </div>
              <div className={styles.riskLevel}>
                <span className={styles.riskColor} style={{background: '#2E8B57'}}></span>
                <strong>Very Low (0-19)</strong>: Excellent pandemic resilience
              </div>
            </div>
          </section>

          <section className={styles.methodologySection}>
            <h3>Scenario Projections</h3>
            <div className={styles.projectionInfo}>
              <h4>2030 Projections:</h4>
              <ul>
                <li><strong>Optimistic (×0.9)</strong>: Assumes continued investment in healthcare, improved global cooperation, technological advances</li>
                <li><strong>Pessimistic (×1.15)</strong>: Accounts for climate change impacts, antimicrobial resistance, healthcare system strain</li>
              </ul>
              
              <h4>2050 Projections:</h4>
              <ul>
                <li><strong>Optimistic (×0.85)</strong>: Assumes major breakthroughs in pandemic prevention, universal health coverage, AI-driven surveillance</li>
                <li><strong>Pessimistic (×1.3)</strong>: Considers severe climate impacts, mass displacement, breakdown of international cooperation</li>
              </ul>
            </div>
          </section>

          <section className={styles.methodologySection}>
            <h3>US State-Level Scoring</h3>
            <p>For US states, we use a comprehensive resilience framework with 7 dimensions:</p>
            <ol>
              <li><strong>Healthcare Infrastructure</strong>: Hospital capacity, ICU beds, healthcare workforce</li>
              <li><strong>Information Systems</strong>: Disease surveillance, data sharing, public communication</li>
              <li><strong>Social Capital</strong>: Community trust, civic engagement, social networks</li>
              <li><strong>Economic Stability</strong>: Employment, income inequality, business resilience</li>
              <li><strong>Governance</strong>: Emergency management, policy coordination, resource allocation</li>
              <li><strong>Physical Infrastructure</strong>: Transportation, utilities, supply chains</li>
              <li><strong>Environmental Health</strong>: Air quality, water systems, climate resilience</li>
            </ol>
          </section>

          <section className={styles.methodologySection}>
            <h3>Data Sources</h3>
            <ul>
              <li>WHO Global Health Observatory</li>
              <li>World Bank Development Indicators</li>
              <li>Johns Hopkins Health Security Index</li>
              <li>CDC National Notifiable Disease Surveillance System</li>
              <li>US Census Bureau Community Resilience Estimates</li>
              <li>FEMA National Risk Index</li>
            </ul>
          </section>
        </div>
      </motion.div>
    </motion.div>
  );
}